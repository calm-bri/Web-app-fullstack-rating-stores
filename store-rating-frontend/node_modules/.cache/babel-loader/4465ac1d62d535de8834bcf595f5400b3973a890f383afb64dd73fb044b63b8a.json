{"ast":null,"code":"var _jsxFileName = \"C:\\\\Assignment_Project_App\\\\Assignment_Roxiler\\\\store-rating-frontend\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect } from \"react\";\n// optional: npm install jwt-decode\nimport jwtDecode from \"jwt-decode\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [user, setUser] = useState(null);\n  const logout = () => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"role\");\n    localStorage.removeItem(\"id\");\n    localStorage.removeItem(\"email\");\n    setUser(null);\n  };\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    const role = localStorage.getItem(\"role\");\n    const id = localStorage.getItem(\"id\");\n    const email = localStorage.getItem(\"email\");\n    if (token && role) {\n      try {\n        const decoded = jwtDecode(token);\n        if (decoded.exp * 1000 < Date.now()) {\n          logout(); // token expired\n        } else {\n          setUser({\n            token,\n            role,\n            id: Number(id),\n            email\n          });\n        }\n      } catch {\n        logout(); // invalid token\n      }\n    }\n\n    // sync across tabs\n    const handleStorageChange = () => {\n      const token = localStorage.getItem(\"token\");\n      const role = localStorage.getItem(\"role\");\n      const id = localStorage.getItem(\"id\");\n      const email = localStorage.getItem(\"email\");\n      setUser(token && role ? {\n        token,\n        role,\n        id: Number(id),\n        email\n      } : null);\n    };\n    window.addEventListener(\"storage\", handleStorageChange);\n    return () => window.removeEventListener(\"storage\", handleStorageChange);\n  }, []);\n  const login = (token, role, id, email) => {\n    localStorage.setItem(\"token\", token);\n    localStorage.setItem(\"role\", role);\n    localStorage.setItem(\"id\", id);\n    localStorage.setItem(\"email\", email);\n    setUser({\n      token,\n      role,\n      id,\n      email\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      login,\n      logout,\n      isAuthenticated: !!user\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthProvider, \"5s2qRsV95gTJBmaaTh11GoxYeGE=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","jwtDecode","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","user","setUser","logout","localStorage","removeItem","token","getItem","role","id","email","decoded","exp","Date","now","Number","handleStorageChange","window","addEventListener","removeEventListener","login","setItem","Provider","value","isAuthenticated","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Assignment_Project_App/Assignment_Roxiler/store-rating-frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from \"react\";\r\n// optional: npm install jwt-decode\r\nimport jwtDecode from \"jwt-decode\";\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n\r\n  const logout = () => {\r\n    localStorage.removeItem(\"token\");\r\n    localStorage.removeItem(\"role\");\r\n    localStorage.removeItem(\"id\");\r\n    localStorage.removeItem(\"email\");\r\n    setUser(null);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n    const role = localStorage.getItem(\"role\");\r\n    const id = localStorage.getItem(\"id\");\r\n    const email = localStorage.getItem(\"email\");\r\n\r\n    if (token && role) {\r\n      try {\r\n        const decoded = jwtDecode(token);\r\n        if (decoded.exp * 1000 < Date.now()) {\r\n          logout(); // token expired\r\n        } else {\r\n          setUser({ token, role, id: Number(id), email });\r\n        }\r\n      } catch {\r\n        logout(); // invalid token\r\n      }\r\n    }\r\n\r\n    // sync across tabs\r\n    const handleStorageChange = () => {\r\n      const token = localStorage.getItem(\"token\");\r\n      const role = localStorage.getItem(\"role\");\r\n      const id = localStorage.getItem(\"id\");\r\n      const email = localStorage.getItem(\"email\");\r\n      setUser(token && role ? { token, role, id: Number(id), email } : null);\r\n    };\r\n\r\n    window.addEventListener(\"storage\", handleStorageChange);\r\n    return () => window.removeEventListener(\"storage\", handleStorageChange);\r\n  }, []);\r\n\r\n  const login = (token, role, id, email) => {\r\n    localStorage.setItem(\"token\", token);\r\n    localStorage.setItem(\"role\", role);\r\n    localStorage.setItem(\"id\", id);\r\n    localStorage.setItem(\"email\", email);\r\n    setUser({ token, role, id, email });\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, login, logout, isAuthenticated: !!user }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}